source code from:

http://www.apuebook.com/code2e.html
http://www.apuebook.com/code3e.html